/** ======================= DADOS DO SCRIPT ======================================================* AUTOR: Gustavo Ferraz Diniz* OBJETIVO: Alteracao das tabelas de negocio do SICONV MEDICAO para a release 2* PRE-REQUISITOS: Modelo da release 1 previamente aplicado*** ======================= HISTÓRICO DE ALTERAÇÕES ==============================================* DATA       | AUTOR                	| MOTIVO* ----------------------------------------------------------------------------------------------* 25/05/2020 | Ana Cristina Soares  	| Alteração da tabela med_submeta_medicao*                                   	| nos campos referentes às assinaturas da empresa*                                   	| e do convenente na submeta *                                   	| (in_situacao_*, nr_cpf_responsavel_*, dt_assinatura_*)* * 22/06/2020 | Gustavo Ferraz Diniz 	| Alteração da tabela med_medicao para adicionar*                                   	| o campo in_bloqueio* * 19/08/2020 | Samuel Meira de Oliveira | Alteração da tabela med_documento_complementar para adicionar*                                   	| os campos nm_licenca e in_eq_lic_inst* */-------------------------------  Tabela: med_observacao  -------------------------------ALTER TABLE siconv.med_observacao ADD in_bloqueio boolean NOT NULL DEFAULT false;COMMENT ON COLUMN siconv.med_observacao.in_bloqueio IS 'Indicador se o registro está bloqueado para edição';-------------------------------  Tabela: med_anexo  -------------------------------ALTER TABLE siconv.med_anexo ADD in_inativo boolean NOT NULL DEFAULT false;COMMENT ON COLUMN siconv.med_anexo.in_inativo IS 'Indicador se o anexo da observação está inativo';-------------------------------  Tabela: med_submeta_medicao  -------------------------------ALTER TABLE siconv.med_submeta_medicao RENAME COLUMN in_situacao TO in_situacao_assinatura;ALTER TABLE siconv.med_submeta_medicao ALTER COLUMN in_situacao_assinatura DROP NOT NULL;ALTER TABLE siconv.med_submeta_medicao ADD dt_ateste timestamp NULL;ALTER TABLE siconv.med_submeta_medicao ADD nr_cpf_resp_ateste bpchar(11) NULL;ALTER TABLE siconv.med_submeta_medicao ADD in_situacao_ateste varchar(3) NULL;COMMENT ON COLUMN siconv.med_submeta_medicao.in_situacao_assinatura IS 'Situação da assinatura da Submeta da Medição';COMMENT ON COLUMN siconv.med_submeta_medicao.dt_ateste IS 'Data do ateste da Submeta da Medição';COMMENT ON COLUMN siconv.med_submeta_medicao.nr_cpf_resp_ateste IS 'CPF do responsável pelo ateste da Submeta da Medição';COMMENT ON COLUMN siconv.med_submeta_medicao.in_situacao_ateste IS 'Situação do ateste da Submeta da Medição';ALTER TABLE siconv.med_submeta_medicao RENAME COLUMN in_situacao_assinatura TO in_situacao_empresa;ALTER TABLE siconv.med_submeta_medicao RENAME COLUMN nr_cpf_resp_assinatura TO nr_cpf_resp_empresa;ALTER TABLE siconv.med_submeta_medicao RENAME COLUMN dt_assinatura TO dt_assinatura_empresa;ALTER TABLE siconv.med_submeta_medicao RENAME COLUMN in_situacao_ateste TO in_situacao_convenente;ALTER TABLE siconv.med_submeta_medicao RENAME COLUMN nr_cpf_resp_ateste TO nr_cpf_resp_convenente;ALTER TABLE siconv.med_submeta_medicao RENAME COLUMN dt_ateste TO dt_assinatura_convenente;COMMENT ON COLUMN siconv.med_submeta_medicao.in_situacao_empresa IS 'Situação da assinatura da Empresa na Submeta da Medição';COMMENT ON COLUMN siconv.med_submeta_medicao.nr_cpf_resp_empresa IS 'CPF do responsável pela assinatura da Empresa na Submeta da Medição';COMMENT ON COLUMN siconv.med_submeta_medicao.dt_assinatura_empresa IS 'Data da assinatura da Empresa na Submeta da Medição';COMMENT ON COLUMN siconv.med_submeta_medicao.in_situacao_convenente IS 'Situação da assinatura do Convenente na Submeta da Medição';COMMENT ON COLUMN siconv.med_submeta_medicao.nr_cpf_resp_convenente IS 'CPF do responsável pela assinatura do Convenente na Submeta da Medição';COMMENT ON COLUMN siconv.med_submeta_medicao.dt_assinatura_convenente IS 'Data da assinatura do Convenente na Submeta da Medição';-------------------------------  Tabela: med_medicao  -------------------------------ALTER TABLE siconv.med_medicao ADD medicao_fk_agrupadora int8 NULL;ALTER TABLE siconv.med_medicao ADD CONSTRAINT fkc_med_medicao_medicao_fk FOREIGN KEY (medicao_fk_agrupadora) REFERENCES siconv.med_medicao(id);ALTER TABLE siconv.med_medicao ADD in_bloqueio boolean NOT NULL DEFAULT false;COMMENT ON COLUMN siconv.med_medicao.medicao_fk_agrupadora IS 'FK da medição agrupadora utilizada na acumulação';COMMENT ON COLUMN siconv.med_medicao.in_bloqueio IS 'Indicador se o registro está bloqueado para edição';-------------------------------  Tabela: med_historico_medicao  -------------------------------ALTER TABLE siconv.med_historico_medicao RENAME COLUMN adt_data_hora TO dt_registro;ALTER TABLE siconv.med_historico_medicao DROP COLUMN adt_login;ALTER TABLE siconv.med_historico_medicao DROP COLUMN adt_operacao;ALTER TABLE siconv.med_historico_medicao DROP COLUMN versao;-------------------------------  Tabela: med_doc_complementar  -------------------------------ALTER TABLE siconv.med_doc_complementar ADD in_bloqueio boolean NOT NULL DEFAULT false;ALTER TABLE siconv.med_doc_complementar ADD nm_licenca varchar(200) NULL;ALTER TABLE siconv.med_doc_complementar ADD in_eq_lic_inst boolean NOT NULL DEFAULT false;COMMENT ON COLUMN siconv.med_doc_complementar.in_bloqueio IS 'Indicador se o registro está bloqueado para edição';COMMENT ON COLUMN siconv.med_doc_complementar.nm_licenca IS 'Nome da Licença quando Tipo Manifesto Ambiental igual a Outros';COMMENT ON COLUMN siconv.med_doc_complementar.in_eq_lic_inst IS 'Indicador de Licença equivalente a Licença de Instalação';